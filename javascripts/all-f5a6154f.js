function _(t){if(!(this instanceof _))return new _(t);this.el="string"==typeof t?document.querySelectorAll(t):t}_.prototype._applyFunc=function(t){var e=Array.prototype.slice.call(arguments,1);"function"==typeof this.el.forEach?this.el.forEach(function(o){this["_"+t].apply(this,[o].concat(e))}.bind(this)):this["_"+t].apply(this,[this.el].concat(e))},_.prototype.fade=function(t,e){this._applyFunc("fade",t,e)},_.prototype._fade=function(t,e,o){function s(){i=n?i+d:i-d,t.style.opacity=i,i<=0&&(t.style.display="none",t.style.opacity=1),(i<=0||i>=1)&&window.clearInterval(c)}var n="in"===e,i=n?0:1,u=10,a=o,d=u/a;n&&("none"===t.style.display&&(t.style.display=""),t.style.opacity=i);var c=window.setInterval(s,u)},function(t){var e=t.querySelector(".nav-mobile-menu-toggle");e&&e.addEventListener("click",function(){var e=t.getElementById("nav");e.classList.toggle("open"),e.classList.contains("open")||(e.classList.add("closed"),setTimeout(function(){e.classList.remove("closed")},1e3))})}(document),function(t){function e(){for(var e=t.getElementsByTagName("a"),o=0;o<e.length;o++){var s=e[o];s.getAttribute("href")&&s.hostname!==location.hostname&&(s.target="_blank")}}e()}(document),function(){var t={apiKey:"AIzaSyAggscqrqgt998lEG0qKLUKIpujLtTjZ_s",authDomain:"shanson-co-31c59.firebaseapp.com",databaseURL:"https://shanson-co-31c59.firebaseio.com",storageBucket:"shanson-co-31c59.appspot.com",messagingSenderId:"855737951921"};"undefined"!=typeof firebase&&firebase.initializeApp(t)}(document),function(){function t(t){if(this.element=t,this.heartElement=t.querySelector(".kudo-heart"),this.postId=t.getAttribute("data-post-id"),this.loadKudos(),!o())return void(this.heartElement.style.display="none");this.isKudoed=!!e()[this.postId],this.isKudoed&&this.element.classList.add("kudoed"),this.bindEvents()}function e(){if(o){var t=JSON.parse(localStorage.getItem("kudos"));return t||(t={},localStorage.setItem("kudos",JSON.stringify(t))),t}}function o(){return"undefined"!=typeof Storage}t.prototype.bindEvents=function(){var t=this;this.heartElement.addEventListener("mouseup",function(){t.isKudoed?t.removeKudo():t.addKudo()})},t.prototype.loadKudos=function(){this.postRef=firebase.database().ref("/posts/"+this.postId),this.postRef.on("value",function(t){t.val()||this.postRef.set({kudos_count:0}),this.postData=t.val()||{kudos_count:0},this.kudosCount=parseInt(this.postData.kudos_count),this.updateKudoCountDisplay(this.kudosCount),_(this.element).fade("in",100)}.bind(this))},t.prototype.addKudo=function(){var t=e();t[this.postId]=!0,localStorage.setItem("kudos",JSON.stringify(t)),this.toggleKudo("add"),this.displayKudoThanks(),this.isKudoed=!0,this.element.classList.add("kudoed"),this.track("add")},t.prototype.toggleKudo=function(t){var e=this;this.postRef.transaction(function(o){return o&&("add"===t?(o.kudos_count=o.kudos_count||0,o.kudos_count++):(o.kudos_count=o.kudos_count||1,o.kudos_count--),e.kudosCount=o.kudos_count,e.updateKudoCountDisplay(e.kudosCount)),o})},t.prototype.removeKudo=function(){var t=e();delete t[this.postId],localStorage.setItem("kudos",JSON.stringify(t)),this.toggleKudo("remove"),this.updateKudoCountDisplay(this.kudosCount),this.isKudoed=!1,this.element.classList.remove("kudoed"),this.track("remove")},t.prototype.displayKudoThanks=function(){var t=this;this.element.querySelector(".kudo-count-message").style.display="none",this.element.querySelector(".kudo-thanks").style.display="block",setTimeout(function(){_(t.element.querySelector(".kudo-thanks")).fade("out",100),setTimeout(function(){_(t.element.querySelector(".kudo-count-message")).fade("in",100)},110)},1500)},t.prototype.updateKudoCountDisplay=function(t){this.element.querySelector(".kudo-count").textContent=t;var e=1===t?"kudo":"kudos";this.element.querySelector(".kudo-word").textContent=e},t.prototype.track=function(t){ga("send","event","kudo",t,document.querySelector(".post-title").textContent)},document.querySelectorAll(".kudo-container").forEach(function(e){new t(e)})}();